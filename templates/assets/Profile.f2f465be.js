import{u as B,e as a,f as O,g as P,o as g,c as f,a as e,t as i,w as p,v as m,h as T,n as y,F as U}from"./index.6091c59e.js";const V={key:0,class:"flex flex-row"},I={class:"w-1/2"},E=e("h1",null,"Edita tu perfil",-1),F=["v-model","onKeyup"],K={class:"avatar"},M={class:"w-24 rounded-full"},N=["src","alt"],q={class:"card-body"},z={class:"card-title"},J={class:"card-text"},L={class:"card-text"},R={key:1},G={setup($){const k=B(),u=a(k.query.id),l=a(null),s=a(null),r=a(null),c=a(null),d=a(null),_=a(!1);u.value!==null&&u.value!==void 0&&u.value!==""&&O(async()=>{l.value=await fetch("/api/auth/token?code="+u.value,{method:"POST"}).then(o=>o.json()),localStorage.setItem("user",JSON.stringify(l.value))}),P(()=>{l.value=JSON.parse(localStorage.getItem("user"))});const w=()=>{localStorage.removeItem("user"),l.value=null,window.location.href="/"},x=()=>{window.location.href="https://obm.auth.us-east-1.amazoncognito.com/login?client_id=7rts72q3ki6tjki5uk0jm3ujd7&response_type=code&scope=email+openid&redirect_uri=https://smartpro.solutions/auth/token"},b=a(null),v=a(null),S=o=>{o.preventDefault(),b.value=o.target.files[0]},h=a(null),C=()=>{const o=new FormData;o.append("file",b.value),fetch(`/api/drive/upload?id=${u.value}`,{method:"POST",body:o}).then(t=>t.json()).then(t=>{h.value=t.url})},j=()=>{_.value=!0,fetch("/api/auth/user/update",{method:"POST",headers:{"Content-Type":"application/json"},body:{id:u.value,username:l.value.username,email:l.value.email,colors:{background:r.value,text:s.value,card:c.value,buttons:d.value},image:h.value,description:v.value}}).then(o=>o.json()).then(o=>{_.value=!1})},D=()=>{v.value=document.getElementById("description").value};return(o,t)=>(g(),f(U,null,[l.value?(g(),f("div",V,[e("div",I,[e("p",null,i(l.value.username),1),e("p",null,i(l.value.email),1),E,p(e("input",{type:"color","onUpdate:modelValue":t[0]||(t[0]=n=>s.value=n)},null,512),[[m,s.value]]),p(e("input",{type:"color","onUpdate:modelValue":t[1]||(t[1]=n=>r.value=n)},null,512),[[m,r.value]]),p(e("input",{type:"color","onUpdate:modelValue":t[2]||(t[2]=n=>c.value=n)},null,512),[[m,c.value]]),p(e("input",{type:"color","onUpdate:modelValue":t[3]||(t[3]=n=>d.value=n)},null,512),[[m,d.value]]),e("textarea",{"v-model":v.value,placeholder:"Describe tu perfil",id:"description",rows:"5",cols:"50",onKeyup:T(D,["enter"])},null,40,F),e("div",null,[e("input",{type:"file",accept:"image/*",onChange:S},null,32)]),e("button",{onClick:C},"Upload")]),e("div",{class:"w-1/2 p-8",style:y({backgroundColor:r.value,color:s.value})},[e("div",K,[e("div",M,[e("img",{src:h.value,class:"avatar online",alt:l.value.username,width:"100",height:"100"},null,8,N)])]),e("div",{class:"card",style:y({backgroundColor:c.value})},[e("div",q,[e("h5",z,i(l.value.username),1),e("p",J,i(l.value.email),1),e("p",L,i(v.value),1)])],4),e("button",{onClick:w,class:"btn btn-primary my-8",style:y({backgroundColor:d.value,color:s.value})}," Logout ",4)],4)])):(g(),f("div",R,[e("button",{onClick:x},"Login")])),e("button",{onClick:j},"Publicar")],64))}};export{G as default};
